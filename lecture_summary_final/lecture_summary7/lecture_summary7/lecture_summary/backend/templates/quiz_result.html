<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results - عون</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='welcome.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='quiz.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Amiri';
            src: url('{{ url_for("static", filename="fonts/Amiri-Bold.ttf") }}') format('truetype');
            font-weight: bold;
            font-style: normal;
        }

        /* Subtle alive feel */
        .alive-bg {
            position: absolute;
            inset: -10% -10% -10% -10%;
            background: radial-gradient(40% 40% at 20% 30%, rgba(139,154,107,0.10) 0%, rgba(139,154,107,0.0) 60%),
                        radial-gradient(35% 35% at 80% 20%, rgba(74,91,42,0.10) 0%, rgba(74,91,42,0.0) 60%),
                        radial-gradient(45% 45% at 50% 80%, rgba(164,179,139,0.10) 0%, rgba(164,179,139,0.0) 60%);
            filter: blur(20px);
            animation: floatSoft 18s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: 0;
        }
        @keyframes floatSoft {
            0%   { transform: translate3d(0, 0, 0) scale(1); }
            50%  { transform: translate3d(10px, -12px, 0) scale(1.02); }
            100% { transform: translate3d(-8px, 10px, 0) scale(1.01); }
        }
        .pulse-soft {
            animation: pulseSoft 2.4s ease-in-out infinite;
        }
        @keyframes pulseSoft {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(107,124,74,0.25); }
            50%      { transform: scale(1.02); box-shadow: 0 8px 24px rgba(107,124,74,0.20); }
        }
        .btn {
            transition: transform .25s ease, box-shadow .25s ease, background .25s ease;
        }
        .btn:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <!-- Top navbar with logo (same style as other pages) -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="logo-icon">
                <span class="logo-text">عون</span>
            </div>
            <div class="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-link">Back to Home</a>
            </div>
        </div>
    </nav>

    <!-- Clean boxed layout (calm card) -->
    <section class="hero-section" style="padding: 8rem 0 4rem; position: relative; overflow: hidden;">
        <div class="alive-bg"></div>
        <div class="hero-container" style="grid-template-columns: 1fr; position: relative; z-index: 1;">
            <div class="card" style="max-width: 800px; margin: 0 auto;">
                <div class="header" style="text-align: center; margin-bottom: 2rem;">
                    <h1 style="color: var(--primary-color); margin-bottom: 0.5rem;">Quiz Results</h1>
                    <p style="color: var(--text-light);">Here's your performance evaluation for the lecture quiz</p>
                </div>

                <!-- Score Summary -->
                <div class="score-summary" style="text-align: center; margin-bottom: 2rem;">
                    <div class="score-display" style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%); color: white; padding: 2rem; border-radius: 20px; display: inline-block; margin-bottom: 1rem; box-shadow: 0 8px 24px rgba(107, 124, 74, 0.3);">
                        <div style="font-size: 3rem; font-weight: 700; margin-bottom: 0.5rem;">{{ "%.0f"|format(score_percentage) }}%</div>
                        <div style="font-size: 1.2rem; opacity: 0.9;">Score</div>
                    </div>
                    
                    <div class="performance-level" style="margin-bottom: 2rem;">
                        <div style="background: {% if performance_color == 'green' %}linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%){% elif performance_color == 'blue' %}linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%){% elif performance_color == 'orange' %}linear-gradient(135deg, #f59e0b 0%, #d97706 100%){% else %}linear-gradient(135deg, #ef4444 0%, #dc2626 100%){% endif %}; color: white; padding: 1rem 2rem; border-radius: 12px; display: inline-block; font-size: 1.2rem; font-weight: 600;">
                            {% if performance_color == 'green' %}🏆 {{ performance_level }}
                            {% elif performance_color == 'blue' %}👍 {{ performance_level }}
                            {% elif performance_color == 'orange' %}📚 {{ performance_level }}
                            {% else %}💪 {{ performance_level }}
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="score-stats" style="display: flex; justify-content: center; gap: 2rem; margin-bottom: 2rem; flex-wrap: wrap;">
                        <div class="stat-item" style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">{{ correct_count }}</div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">Correct</div>
                        </div>
                        <div class="stat-item" style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--accent-color);">{{ total_questions - correct_count }}</div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">Wrong</div>
                        </div>
                        <div class="stat-item" style="text-align: center;">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--text-light);">{{ "%.1f"|format(time_taken / 60) }}</div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">Minutes</div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Results -->
                <div class="detailed-results" style="margin: 2rem 0;">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem; text-align: center;">Answer Details</h3>
                    <div class="results-list" style="display: flex; flex-direction: column; gap: 1rem;">
                        {% for result in detailed_results %}
                        <div class="result-item" style="padding: 1rem; background: {% if result.is_correct %}rgba(107, 124, 74, 0.1){% else %}rgba(220, 38, 38, 0.1){% endif %}; border: 1px solid {% if result.is_correct %}var(--primary-color){% else %}var(--accent-color){% endif %}; border-radius: 12px;">
                            <div class="result-header" style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                <div class="result-icon" style="font-size: 1.5rem;">
                                    {% if result.is_correct %}✅{% else %}❌{% endif %}
                                </div>
                                <div class="result-question" style="color: var(--text-dark); font-weight: 600;">{{ result.question }}</div>
                            </div>
                            
                            <div class="result-answers" style="margin-right: 2rem;">
                                <div class="answer-section" style="margin-bottom: 0.5rem;">
                                    <strong style="color: var(--text-light);">Your Answer:</strong>
                                    <span class="user-answer" style="color: var(--text-dark); margin-right: 0.5rem;">{{ result.user_answer }}</span>
                                </div>
                                {% if not result.is_correct %}
                                <div class="answer-section">
                                    <strong style="color: var(--primary-color);">Correct Answer:</strong>
                                    <span class="correct-answer" style="color: var(--primary-color); margin-right: 0.5rem;">{{ result.correct_answer }}</span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Performance Feedback -->
                <div class="performance-feedback" style="margin: 2rem 0; text-align: center;">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">Performance Evaluation</h3>
                    <div class="feedback-content">
                        {% if performance_color == 'green' %}
                        <div class="feedback-message" style="background: rgba(107, 124, 74, 0.1); border: 1px solid var(--primary-color); border-radius: 12px; padding: 1.5rem;">
                            <h4 style="color: var(--primary-color); margin-bottom: 0.5rem;">🎉 ممتاز!</h4>
                            <p style="color: var(--text-dark);">أداء رائع! لقد أظهرت فهماً عميقاً لمحتوى المحاضرة. استمر في هذا المستوى المتميز.</p>
                        </div>
                        {% elif performance_color == 'blue' %}
                        <div class="feedback-message" style="background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; border-radius: 12px; padding: 1.5rem;">
                            <h4 style="color: #3b82f6; margin-bottom: 0.5rem;">👍 جيد جداً!</h4>
                            <p style="color: var(--text-dark);">أداء جيد! لديك فهم جيد للموضوع، لكن يمكنك تحسين بعض النقاط. راجع الأجزاء التي أخطأت فيها.</p>
                        </div>
                        {% elif performance_color == 'orange' %}
                        <div class="feedback-message" style="background: rgba(245, 158, 11, 0.1); border: 1px solid #f59e0b; border-radius: 12px; padding: 1.5rem;">
                            <h4 style="color: #f59e0b; margin-bottom: 0.5rem;">📚 مقبول</h4>
                            <p style="color: var(--text-dark);">أداء مقبول، لكن هناك مجال للتحسين. ننصحك بمراجعة المحاضرة مرة أخرى والتركيز على النقاط المهمة.</p>
                        </div>
                        {% else %}
                        <div class="feedback-message" style="background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; border-radius: 12px; padding: 1.5rem;">
                            <h4 style="color: #ef4444; margin-bottom: 0.5rem;">💪 يحتاج تحسين</h4>
                            <p style="color: var(--text-dark);">لا تقلق! هذا يعني أن لديك فرصة رائعة للتعلم. راجع المحاضرة بعناية وكرر الاختبار لتحسين فهمك.</p>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons" style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap;">
                    <a href="/quiz" class="btn btn-primary">🔄 Retake Quiz</a>
                    <a href="/tutor" class="btn btn-secondary">🎓 Back to AI Tutor</a>
                    <a href="/explanation" class="btn btn-secondary">📄 Back to Home</a>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Add some interactive animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate score display
            const scoreDisplay = document.querySelector('.score-display');
            const scorePercentage = {{ "%.0f"|format(score_percentage) }};
            
            setTimeout(() => {
                scoreDisplay.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    scoreDisplay.style.transform = 'scale(1)';
                }, 200);
            }, 500);

            // Animate result items
            const resultItems = document.querySelectorAll('.result-item');
            resultItems.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    item.style.transition = 'all 0.3s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, 800 + (index * 100));
            });
        });
    </script>
</body>
</html>
